<!DOCTYPE html>
<html>
<head>
    <title>OAuth Callback</title>
</head>
<body>
    <script>
        console.log("Callback page loaded.");
        const hashParams = new URLSearchParams(window.location.hash.substring(1));
        const accessToken = hashParams.get('access_token');
        console.log("Access Token:", accessToken);

        if (accessToken) {
            console.log("callback.html: Sending store-token-ui message");
            window.top.postMessage({ // Use window.top
                pluginMessage: {
                    type: "store-token-ui",
                    token: accessToken
                }
            }, "*");
        } else {
            console.error("Access token not found in URL.");
        }
    </script>
</body>
</html>